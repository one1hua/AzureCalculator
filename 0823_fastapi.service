Description=FastAPI (uvicorn) - Azure Pricing + RAG
After=network.target

[Service]
Type=simple
# ★ pyenv/venv 의 uvicorn 실행기 경로로 바꾸세요
ExecStart=/home/azureuser/.pyenv/versions/py3_11_9/bin/uvicorn fastapi_server:app --host 0.0.0.0 --port 8000 --root-path /api
WorkingDirectory=/home/azureuser/work/work/streamlit_basic/project01/apiserver

# 환경변수 (★ DB 절대경로 맞춰주세요)
Environment="PRICE_DB=/home/azureuser/hmtest/work/pjt01/apiserver/data/azure_price_data.db"
# (선택) 환율 기본값 고정 시
#Environment="FX_USD_KRW=1390.0"
# (선택) OpenAI 설정이 있다면 여기에
# Environment="AZURE_OPENAI_API_KEY=..."
# Environment="AZURE_OPENAI_ENDPOINT=https://xxx.openai.azure.com"
# Environment="AZURE_OPENAI_CHAT_DEPLOYMENT=gpt-4o"
# Environment="AZURE_OPENAI_EMBED_DEPLOYMENT=text-embedding-3-small"
# Environment="AZURE_OPENAI_API_VERSION=2024-12-01-preview"

Restart=always
RestartSec=3
User=azureuser
Group=azureuser
# 로그 버퍼
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
